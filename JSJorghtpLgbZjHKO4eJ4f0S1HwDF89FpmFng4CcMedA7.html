<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Orders and sells - Gift Zone</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="manifest" href="manifest.json">
    <meta name="background-color" content="bg-blue-600" />
    <meta name="background-color" content="#f3f4f6" />
    <meta name="apple-mobile-web-app-title" content="Gift Zone">
    <link rel="apple-touch-icon" href="fav.jpg">
    <meta name="theme-color" content="#f3f4f6" />
    <meta name="apple-mobile-web-app-status-bar-style" content="#f3f4f6" />
    <meta name="msapplication-navbutton-color" content="#f3f4f6" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body class=" w-full top-0 left-0 fixed font-extrabold flex items-center justify-center ">
    <div styl="background: linear-gradient(90deg, #b90f2a 0%, #2e143a 100%)"
        class="  w-full flex flex-col md:flex-row overflow-hidden">
        <div id="funLoader" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <div class="w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin">
            </div>
        </div>
        <!-- Toggle Button (Visible only on mobile) -->
        <div class="flex items-center md:px-0 px-2 h-full justify-between">
            <button id="menuToggle" type="button" class="p-3 text-gray-700 focus:outline-none">
                <i class="fas fa-bars text-xl"></i>

            </button>

            <button onclick=" window.location.href='index.html'" aria-label="Go back"
                class="text-2xl  md:hidden flex justify-center items-center shadow-sm">

                <h1 class="font-extrabold text-black text-2x1 mx-auto sm:text-base leading-none">
                    Gift Zone
                </h1>
            </button>

            <button onclick="toggleMenu()" class="md:hidden hidden p-3 text-gray-700 focus:outline-none0">
                <i class="fas fa-ellipsis-v text-xl text-gray-700"></i>
            </button>

            <!-- Menu -->
            <div id="menu" class="hidden absolute right-0 top-12 w-40 bg-white border z-50 rounded-lg shadow-lg">
                <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <i class="fas fa-pen mr-2"></i> Edit
                </a>
                <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <i class="fas fa-trash mr-2"></i> Delete
                </a>
                <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <i class="fas fa-share mr-2"></i> Share
                </a>
            </div>

            <script>
                function toggleMenu() {
                    document.getElementById("menu").classList.toggle("hidden");
                }
            </script>
        </div>
        <div id="overlay" class="fixed left-0 inset-0 bg-black bg-opacity-50 hidden "></div>
        <!-- Sidebar -->

        <aside id="sidebar" class="fixed overflow-auto top-0 left-0 h-full w-56 bg-black text-white font-extrabold border-r border-gray-200 flex flex-col py-8
         transform -translate-x-full transition-transform duration-300 ease-in-out
       md:-translate-x-0 md:w-40
         ">
            <div onclick="window.location.href='index.html'"
                class="mx-auto flex flex-col items-center justify-center text-white text-center mb-8">
                <img src="fav.jpg" alt="ClassyShop logo white square white text ClassyShop"
                    class="w-32 object-contain mb-2 object-cover rounded-full border-white border-2 " width="160"
                    height="40" />
                <h1 id="ownername" class="font-bold text-sm text-white">Gift Zone</h1>
                <h1 id="ownermail" class="font-bold text-sm text-white">Giftzone@gmail.com</h1>
            </div>


            <nav class="flex flex-col space-y-1  text-gray-700 font-semibold">
                <button data-section="dashboard"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('dashboard', this)" type="button">
                    <i class="fas fa-th-large text-base"></i>
                    <span>Dashboard</span>
                    <span id="loggedUserEmail"></span>
                </button>

                <button data-section="objectives"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('objectives', this)" type="button">
                    <i class="fas fa-bullseye text-base"></i>
                    <span>Objectives</span>
                </button>

                <button data-section="survey"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('survey', this)" type="button">
                    <i class="fas fa-check-square text-base"></i>
                    <span>Products</span>
                </button>


                <button data-section="documents"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('documents', this)" type="button">
                    <i class="fas fa-file-alt text-base"></i>
                    <span>Documents</span>
                </button>

                <button data-section="photos"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('photos', this)" type="button">
                    <i class="fas fa-camera text-base"></i>
                    <span>Photos</span>
                </button>

                <button data-section="sells"
                    class="flex items-center space-x-3 text-orange-500 font-semibold px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('sells', this)" type="button">
                    <i class="fas fa-shopping-cart text-base"></i>
                    <span>Sells</span>
                </button>

                <button data-section="message"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('message', this)" type="button">
                    <i class="fas fa-comment-alt text-base"></i>
                    <span>Message</span>
                </button>

                <button data-section="help"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('help', this)" type="button">
                    <i class="fas fa-question-circle text-base"></i>
                    <span>Help</span>
                </button>

                <button data-section="setting"
                    class="flex items-center space-x-3 text-gray-100 hover:text-orange-500 transition-colors px-3 py-2 rounded-md focus:outline-none text-base"
                    onclick="selectSection('setting', this)" type="button">
                    <i class="fas fa-cog text-base"></i>
                    <span>Setting</span>
                </button>
            </nav>

        </aside>

        <!-- Main content -->
        <main class="flex-1 px-2 md:p-2 md:ml-32 md:mx-1 flex flex-col overflow-auto overflow-x-auto">

            <div class=" flex  revrse sm:flex-row sm:items-center sm:justify-between mb-6 gap-4 sm:gap-0">
                <select aria-label="Show products"
                    class="hidden  border border-gray-300 rounded-full text-xs text-gray-600 px-6 py-3 focus:outline-none">
                    <option>All Products</option>
                    <option>Product 1</option>
                    <option>Product 2</option>
                    <option>Product 3</option>
                    <option>Product 4</option>

                </select>
                <div class="flex items-center bg-gray-200 rounded-full px-4 py-1 w-full md:mr-2">
                    <input type="text" placeholder="Search  +  Orders +  Files  +  Products"
                        class="bg-transparent focus:outline-none text-gray-600 placeholder-gray-400 text-sm w-full" />
                    <button aria-label="Search"
                        class="ml-2 w-8 h-8 flex items-center justify-center rounded-full text-gray-400  transition">
                        <i class="fas fa-search text-lg font-extrabold text-gray-600"></i>
                    </button>
                </div>

                <div class="flex items-center space-x-3">

                    <button onclick="showForm()"
                        class="bg-orange-500 text-white rounded-full w-full text-xs font-extrabold px-6 py-3 hover:bg-orange-600 transition-colors">
                        +Product
                    </button>
                </div>
            </div>

            <div id="formContainer" class="fixed hidden shadow-[0_8px_80px_black] inset-0 md:mx-auto m-2 mb-4 md:top-10 h-full bottom-auto md:max-h-[85vh] md:max-w-7xl overflow-y-auto 
         bg-white rounded-3xl shadow-2xl border border-orange-300 p-4">
                <h2 id="formTitle"
                    class="text-2xl font-semibold mb-8 text-orange-500 border-b border-orange-300 pb-3 flex items-center gap-2">
                    <i class="fas fa-plus-circle text-orange-500"></i> Add Record
                </h2>
                <form id="crudForm" class="w-full text-sm grid grid-cols-4 sm:grid-cols-4 md:grid-cols-4 gap-4 z-50">
                    <input type="hidden" id="Id" name="Id">

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Date">Date</label>
                        <input type="text" id="Date" name="Date" placeholder="YYYY-MM-DD"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Time">Time</label>
                        <input type="text" id="Time" name="Time" placeholder="HH:MM AM/PM"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Name">Name</label>
                        <input type="text" id="Name" name="Name"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Number">Number</label>
                        <input type="text" id="Number" name="Number"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Size">Size</label>
                        <input type="text" id="Size" name="Size"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Material">Material</label>
                        <input type="text" id="Material" name="Material"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Color">Color</label>
                        <input type="text" id="Color" name="Color"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Address">Address</label>
                        <input type="text" id="Address" name="Address"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="City">City</label>
                        <input type="text" id="City" name="City"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Pincode">Pincode</label>
                        <input type="text" id="Pincode" name="Pincode"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="State">State</label>
                        <input type="text" id="State" name="State"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Status">Status</label>
                        <input type="text" id="Status" name="Status"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Payment">Payment</label>
                        <input type="text" id="Payment" name="Payment"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Other">Other</label>
                        <input type="text" id="Other" name="Other"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>
                    <div>
                        <label class="block text-orange-500 font-medium mb-1" for="Level">Level</label>
                        <select id="Level" name="Level"
                            class="w-full p-2 border border-orange-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400 transition">
                            <option value="">Select Level</option>
                            <option value="1">Level 1</option>
                            <option value="2">Level 2</option>
                            <option value="3">Level 3</option>
                            <option value="4">Level 4</option>
                        </select>
                    </div>


                    <div class=" ">
                        <label class="block text-orange-500 font-medium mb-1" for="ImageInput">Upload Image</label>
                        <input type="file" id="ImageInput" name="ImageInput" accept="image/*"
                            class="w-full p-2 border border-orange-300 rounded-lg cursor-pointer focus:outline-none focus:ring-2 focus:ring-orange-400 transition" />
                    </div>

                    <div class="sm:col-span-2 md:col-span-4 flex justify-end gap-4 mt-4">
                        <button type="button" onclick="hideForm()"
                            class="px-6 py-2 bg-orange-200 text-orange-700 font-semibold rounded-lg hover:bg-orange-300 transition flex items-center gap-2">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <button type="submit" id="actionBtn" onclick="showLoader()"
                            class="px-6 py-2 bg-orange-600 text-white font-semibold rounded-lg hover:bg-orange-700 transition flex items-center gap-2">
                            <i class="fas fa-save"></i>
                            Save
                        </button>
                    </div>
                </form>


            </div>

            <!-- Sections container -->
            <section id="dashboard" class="hidden">
                <h2 class="text-orange-500 font-semibold text-xl mb-6">Dashboard</h2>

                <script src="https://cdn.tailwindcss.com"></script>
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

                <body class="bg-gray-100 flex justify-center items-center min-h-screen p-4">

                    <div class="bg-white p-4 rounded-lg shadow w-full max-w-6xl grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <h2 class="text-center font-semibold mb-2">Bar Chart</h2><canvas id="barChart"></canvas>
                        </div>
                        <div>
                            <h2 class="text-center font-semibold mb-2">Line Chart</h2><canvas id="lineChart"></canvas>
                        </div>
                        <div>
                            <h2 class="text-center font-semibold mb-2">Pie Chart</h2><canvas id="pieChart"></canvas>
                        </div>

                    </div>


                </body>
            </section>

            <section id="objectives" class="hidden">
                <h2 class="text-orange-500 font-semibold text-xl mb-6">Objectives</h2>

                <body class="bg-gray-100 flex justify-center items-center min-h-screen p-4">

                    <div class="bg-white p-4 rounded-lg shadow w-full max-w-6xl grid grid-cols-1 md:grid-cols-3 gap-6">

                        <div>
                            <h2 class="text-center font-semibold mb-2">Doughnut Chart</h2><canvas
                                id="doughnutChart"></canvas>
                        </div>
                        <div>
                            <h2 class="text-center font-semibold mb-2">Polar Area Chart</h2><canvas
                                id="polarChart"></canvas>
                        </div>
                        <div>
                            <h2 class="text-center font-semibold mb-2">Radar Chart</h2><canvas id="radarChart"></canvas>
                        </div>
                    </div>

                    <script>
                        const API_ALL = "https://script.google.com/macros/s/AKfycbzMq8ZIKjp_zbvuGStwYd7m4eizacjlrwPyu3vxuCxLCLC_iPAIiU-2imLLM0yVJxNb/exec";

                        async function renderAllCharts() {
                            const res = await fetch(`${API_ALL}?action=read`).then(r => r.json());
                            const counts = {};
                            res.records.forEach(r => counts[r.Id] = (counts[r.Id] || 0) + 1);
                            const labels = Object.keys(counts);
                            const data = Object.values(counts);
                            const colors = labels.map((_, i) => `hsl(${i * 40 % 360},70%,60%)`);

                            // Bar
                            new Chart(document.getElementById("barChart"), { type: "bar", data: { labels, datasets: [{ label: "Id Count", data, backgroundColor: colors }] }, options: { responsive: true, scales: { y: { beginAtZero: true, ticks: { stepSize: 1 } } } } });

                            // Line
                            new Chart(document.getElementById("lineChart"), { type: "line", data: { labels, datasets: [{ label: "Id Count", data, backgroundColor: colors, borderColor: colors, borderWidth: 2, fill: false }] }, options: { responsive: true, scales: { y: { beginAtZero: true } } } });

                            // Pie
                            new Chart(document.getElementById("pieChart"), { type: "pie", data: { labels, datasets: [{ data, backgroundColor: colors }] }, options: { responsive: true, plugins: { legend: { position: 'right' } } } });

                            // Doughnut
                            new Chart(document.getElementById("doughnutChart"), { type: "doughnut", data: { labels, datasets: [{ data, backgroundColor: colors }] }, options: { responsive: true, plugins: { legend: { position: 'right' } } } });

                            // Polar Area
                            new Chart(document.getElementById("polarChart"), { type: "polarArea", data: { labels, datasets: [{ data, backgroundColor: colors }] }, options: { responsive: true } });

                            // Radar
                            new Chart(document.getElementById("radarChart"), { type: "radar", data: { labels, datasets: [{ label: "Id Count", data, backgroundColor: "rgba(243,115,22,0.4)", borderColor: "#f97316", borderWidth: 2, pointBackgroundColor: colors }] }, options: { responsive: true, scales: { r: { beginAtZero: true } } } });
                        }

                        renderAllCharts();
                    </script>

                </body>

            </section>

            <section id="survey" class="hidden">

                <div class="max-w-7xl mx-auto">

                    <!-- Filter Section -->
                    <div class="mb-4 flex justify-between space-x-2">

                        <div>
                            <button onclick="showFormCopy()"
                                class="bg-blue-600 hover:bg-green-700 text-white px-6 py-2 rounded-md shadow">+
                                Add New</button>
                        </div>
                        <div>
                            <select id="filterFieldCopy"
                                class="p-2 border rounded-lg shadow-sm focus:ring-2 focus:ring-blue-300 focus:outline-none text-sm">
                                <option value="">All Fields</option>
                                <option value="Id">Id</option>
                                <option value="Date">Date</option>
                                <option value="Time">Time</option>
                                <option value="Name">Name</option>
                                <option value="Number">Number</option>
                                <option value="Material">Material</option>
                                <option value="Color">Color</option>
                                <option value="Address">Address</option>
                                <option value="City">City</option>
                                <option value="Pincode">Pincode</option>
                                <option value="State">State</option>
                                <option value="Status">Status</option>
                                <option value="Payment">Payment</option>
                                <option value="Other">Other</option>
                            </select>

                            <input type="text" id="searchInputCopy" placeholder="Search..."
                                class="w-72 p-2 border rounded-lg shadow-sm focus:ring-2 focus:ring-blue-300 focus:outline-none text-sm">
                        </div>
                    </div>



                    <div class="bg-white shadow rounded-lg md:mb-20 w-full  md:max-h-[80vh]">
                        <!-- Wrapper for scrolling -->
                        <div class="overflow-x-auto overflow-y-auto max-h-[98vh] md:max-h-[80vh]">
                            <table class="min-w-full border border-gray-200 text-xs text-gray-700">
                                <thead class="bg-gray-100 text-gray-600 w-full uppercase tracking-wider">
                                    <tr class="">
                                        <th class="p-2 border">Id</th>
                                        <th class="p-2 border">Icon</th>
                                        <th class="p-2 border">Date & Time</th>

                                        <th class="p-2 border">Categories</th>

                                        <th class="p-2 border">Size & Price</th>
                                        <th class="p-2 border">Material & Color</th>

                                        <th class="p-2 border">Specification</th>

                                        <th class="p-2 border">Status</th>

                                        <th class="p-2 border">Level</th>

                                        <th class="p-2 border">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="productListCopy" class="divide-y divide-gray-200">
                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                    </div>


                    <!-- Form (hidden by default) -->
                    <div id="formContainerCopy" class="fixed hidden shadow-[0_8px_80px_black] inset-0 md:mx-auto m-2 mb-4 md:top-10 h-full bottom-auto md:max-h-[85vh] md:max-w-7xl overflow-y-auto 
                              bg-white rounded-3xl shadow-2xl border border-orange-300 p-4">
                        <h2 id="formTitleCopy" class="text-base font-semibold mb-6 text-gray-800 border-b pb-2">Add
                            Record</h2>

                        <form id="crudFormCopy" class="grid grid-cols-4 gap-4 text-sm">
                            <div>
                                <label class="block text-gray-600 mb-1">ID</label>
                                <input type="number" id="IdCopy" name="Id" required minlength="4"
                                    class="w-full p-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">Icon</label>
                                <input type="text" name="Icon" class="w-full p-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">Date</label>
                                <input type="text" id="dateInput" name="Date" class="w-full p-2 border rounded-lg"
                                    placeholder="YYYY-MM-DD">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">Time</label>
                                <input type="text" id="timeInput" name="Time" class="w-full p-2 border rounded-lg"
                                    placeholder="HH:MM AM/PM">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">Category</label>
                                <select name="Category" class="w-full p-2 border rounded-lg">
                                    <option value="all">All Frames</option>
                                    <option value="Single">Single Frame</option>
                                    <option value="Double">Double Frame</option>
                                    <option value="Triple">Triple Frame</option>
                                    <option value="Multiple">Multiple Frames</option>
                                    <option value="Calendar">Calendar Frames</option>
                                    <option value="Trending">Trending</option>
                                    <option value="Lovely">Lovely Frames</option>
                                </select>
                            </div>


                            <div>
                                <label class="block text-gray-600 mb-1">Tittle</label>
                                <input type="text" name="Tittle" class="w-full p-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">SubTittle</label>
                                <input type="text" name="SubTittle" class="w-full p-2 border rounded-lg">
                            </div>
                            <div class="hidden">
                                <label class="block text-gray-600 mb-1">Size</label>
                                <input type="text" name="Size" class="w-full p-2 border rounded-lg">
                            </div>
                            <div class="hidden">
                                <label class="block text-gray-600 mb-1">Material</label>
                                <input type="text" name="Material" class="w-full p-2 border rounded-lg">
                            </div>
                            <div class="hidden">
                                <label class="block text-gray-600 mb-1">Color</label>
                                <input type="text" name="Color" class="w-full p-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">Specification</label>
                                <select name="Specification" class="w-full p-2 border rounded-lg">
                                    <option value="">Select Specification</option>

                                    <option
                                        value="This elegant photo frame is crafted from high-quality wood with a smooth matte finish, designed for both wall mount and tabletop display. The glass front provides excellent clarity and protects your photo from dust and moisture. Its minimal yet stylish design suits all interiors — from classic to modern. Perfect for displaying portraits, certificates, or art prints, the frame ensures long-lasting durability with a non-fading finish that preserves your memories beautifully. Includes metal hooks and back stand for easy placement.">
                                        Wall Mount & Tabletop Display
                                    </option>

                                    <option
                                        value="This photo frame uses premium scratch-resistant acrylic glass that ensures lasting clarity while being lightweight and safer than traditional glass. The surface is UV-protected to prevent yellowing or fading over time, keeping your photos as vibrant as the day they were printed. The frame body is crafted from eco-friendly wood composite, offering strength and style. Ideal for gifting or showcasing special moments, it provides a clear, reflection-free view that enhances every image.">
                                        Scratch-Resistant Acrylic Glass
                                    </option>

                                    <option
                                        value="The lightweight wooden frame design combines elegance with practicality. Crafted from sustainable pinewood, it’s easy to handle, hang, or move. Despite its light build, it maintains exceptional rigidity, preventing warping over time. A soft-touch protective coating enhances the texture and resists fingerprints. Suitable for offices, homes, or galleries, this frame’s versatility and premium aesthetic make it a timeless choice for decorators and collectors alike.">
                                        Lightweight Wooden Frame
                                    </option>

                                    <option
                                        value="This premium gloss finish photo frame offers a stunning reflective sheen that enhances the depth and contrast of your photos. Its multi-layered lacquer coating resists scratches, fingerprints, and fading. Designed to add a touch of luxury to your living space, this frame’s smooth surface beautifully complements both monochrome and color images. The high-gloss coating also makes it easy to clean and maintain, ensuring that it continues to look brand new for years.">
                                        Premium Gloss Finish
                                    </option>

                                    <option
                                        value="Gift-ready packaging makes this frame the perfect choice for special occasions like weddings, birthdays, and anniversaries. Each frame is carefully wrapped in protective layers and enclosed in a decorative box. The packaging is eco-conscious, using recyclable materials and zero plastic. The unboxing experience is designed to impress, ensuring that your loved ones receive a premium product in flawless condition — ready to be presented straight out of the box.">
                                        Gift-Ready Packaging
                                    </option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-gray-600 mb-1">Rating</label>
                                <select name="Ratting" class="w-full p-2 border rounded-lg">
                                    <option value="">Select Rating</option>
                                    <option value="5.0">⭐⭐⭐⭐⭐ 5.0</option>
                                    <option value="4.9">⭐⭐⭐⭐⭐ 4.9</option>
                                    <option value="4.8">⭐⭐⭐⭐⭐ 4.8</option>
                                    <option value="4.7">⭐⭐⭐⭐⭐ 4.7</option>
                                    <option value="4.6">⭐⭐⭐⭐⭐ 4.6</option>
                                    <option value="4.5">⭐⭐⭐⭐⭐ 4.5</option>
                                    <option value="4.4">⭐⭐⭐⭐⭐ 4.4</option>
                                    <option value="4.3">⭐⭐⭐⭐⭐ 4.3</option>
                                    <option value="4.2">⭐⭐⭐⭐⭐ 4.2</option>
                                    <option value="4.1">⭐⭐⭐⭐⭐ 4.1</option>
                                    <option value="4.0">⭐⭐⭐⭐ 4.0</option>
                                    <option value="3.9">⭐⭐⭐⭐ 3.9</option>
                                    <option value="3.8">⭐⭐⭐⭐ 3.8</option>
                                    <option value="3.7">⭐⭐⭐⭐ 3.7</option>
                                    <option value="3.6">⭐⭐⭐⭐ 3.6</option>
                                    <option value="3.5">⭐⭐⭐⭐ 3.5</option>
                                    <option value="3.4">⭐⭐⭐⭐ 3.4</option>
                                    <option value="3.3">⭐⭐⭐⭐ 3.3</option>
                                    <option value="3.2">⭐⭐⭐⭐ 3.2</option>
                                    <option value="3.1">⭐⭐⭐⭐ 3.1</option>
                                    <option value="3.0">⭐⭐⭐ 3.0</option>
                                    <option value="2.9">⭐⭐⭐ 2.9</option>
                                    <option value="2.8">⭐⭐⭐ 2.8</option>
                                    <option value="2.7">⭐⭐⭐ 2.7</option>
                                    <option value="2.6">⭐⭐⭐ 2.6</option>
                                    <option value="2.5">⭐⭐⭐ 2.5</option>
                                    <option value="2.4">⭐⭐⭐ 2.4</option>
                                    <option value="2.3">⭐⭐⭐ 2.3</option>
                                    <option value="2.2">⭐⭐⭐ 2.2</option>
                                    <option value="2.1">⭐⭐⭐ 2.1</option>
                                    <option value="2.0">⭐⭐ 2.0</option>
                                    <option value="1.9">⭐⭐ 1.9</option>
                                    <option value="1.8">⭐⭐ 1.8</option>
                                    <option value="1.7">⭐⭐ 1.7</option>
                                    <option value="1.6">⭐⭐ 1.6</option>
                                    <option value="1.5">⭐⭐ 1.5</option>
                                    <option value="1.4">⭐⭐ 1.4</option>
                                    <option value="1.3">⭐⭐ 1.3</option>
                                    <option value="1.2">⭐ 1.2</option>
                                    <option value="1.1">⭐ 1.1</option>
                                    <option value="1.0">⭐ 1.0</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-gray-600 mb-1">Price</label>
                                <input type="number" name="Price" class="w-full p-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">Cash</label>
                                <select name="Cash" class="w-full p-2 border rounded-lg">
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-gray-600 mb-1">Online</label>
                                <select name="Online" class="w-full p-2 border rounded-lg">
                                    <option value="">Select</option>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-gray-600 mb-1">Reviews</label>
                                <input type="text" name="Reviews" class="w-full p-2 border rounded-lg">
                            </div>
                            <div class="col-span-2">
                                <label class="block text-gray-600 mb-1">Image</label>
                                <input type="file" id="ImageInputopy" name="Image" accept="image/*"
                                    class="w-full p-2 border rounded-lg">
                            </div>
                            <div class="hidden">
                                <label class="block text-gray-600 mb-1">Level</label>
                                <input type="text" name="Level" class="w-full p-2 border rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-600 mb-1">Status</label>
                                <select name="Status" class="w-full p-2 border rounded-lg">
                                    <option value="">Select Status</option>
                                    <option value="In Stock">In Stock</option>
                                    <option value="Out of Stock">Out of Stock</option>
                                    <option value="Coming Soon">Coming Soon</option>
                                    <option value="Discontinued">Discontinued</option>
                                    <option value="Preorder">Preorder</option>
                                </select>
                            </div>

                            <div class="col-span-2 hidden ">
                                <label class="block text-gray-600 mb-1">Filtered</label>
                                <input type="text" name="Filtered" class="w-full p-2 border rounded-lg">
                            </div>

                            <div class="md:fixed bottom-20 right-20 col-span-2 flex justify-end space-x-3 mt-6">
                                <button type="button" onclick="hideFormCopy()"
                                    class="px-10 py-2 bg-gray-500 text-white rounded-lg">Cancel</button>
                                <button type="submit" onclick="showLoader()"
                                    class="px-10 py-2 bg-blue-600 text-white rounded-lg">
                                    Save</button>
                            </div>
                        </form>

                    </div>

                    <!-- Add Button -->

                </div>

                <script>


                    const API_URL_COPY = "https://script.google.com/macros/s/AKfycbzMq8ZIKjp_zbvuGStwYd7m4eizacjlrwPyu3vxuCxLCLC_iPAIiU-2imLLM0yVJxNb/exec";
                    let isEditingCopy = false;
                    let allRecordsCopy = [];

                    function formatDateCopy(dateValue) {
                        if (!dateValue) return "";
                        if (!isNaN(dateValue)) {
                            let jsDate = new Date(Math.round((dateValue - 25569) * 86400 * 1000));
                            return jsDate.toLocaleDateString("en-GB");
                        }
                        let date = new Date(dateValue);
                        if (isNaN(date)) return dateValue;
                        return date.toLocaleDateString("en-GB");
                    }

                    function formatTimeCopy(timeValue) {
                        if (!timeValue) return "";
                        if (!isNaN(timeValue)) {
                            let totalMinutes = Math.round(timeValue * 24 * 60);
                            let hours = Math.floor(totalMinutes / 60);
                            let minutes = totalMinutes % 60;
                            let period = hours >= 12 ? "PM" : "AM";
                            hours = hours % 12 || 12;
                            return `${hours}:${minutes.toString().padStart(2, "0")} ${period}`;
                        }
                        let date = new Date(`1970-01-01T${timeValue}`);
                        if (isNaN(date)) return timeValue;
                        return date.toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit", hour12: true });
                    }

                    function renderTableCopy(records) {
                        const tbody = document.getElementById("productListCopy");
                        tbody.innerHTML = "";
                        records.forEach(record => {
                            tbody.innerHTML += `
                <tr class="hover:bg-gray-50">
                    <td class="border p-2 whitespace-nowrap">${record.Id}</td>
                <td class="border p-2 w-20 h-20 flex items-center justify-center">
  <img src="${record.Icon}" alt="Product" class="rounded border-2 w-full h-full object-cover"/>
</td>

                    <td class="border p-2 flex-col">
                        <div class="font-extrabold">${record.Tittle}</div>
                        <div>${formatTimeCopy(record.Time)}</div>
                        <div>${formatDateCopy(record.Date)}</div>
                    </td>
                    <td class="border p-2 "> <b>Category</b>: ${record.Category}</div></td>
                    <td class="border p-2 whitespace-nowrap">
                         <div><b>Size</b>: ${record.Size}</div>
                        <div><b>Price</b>: ${record.Price} .Rs</div>
                        </td>
                    <td class="border p-2 whitespace-nowrap flex-col">
                        <div><b>Material</b>: ${record.Material}</div>
                        <div><b>Color</b>: ${record.Color}</div>
                        <div><b>Rating</b>: ${record.Ratting}</div>
                    </td>
                    <td class="border  overflow-hidden p-2 h-2 flex-col">
                        <div>${record.Specification}</div>
                    </td>
                    <td class="border p-2 whitespace-nowrap flex-col">
                       
                        <div><b>Cash</b>: ${record.PaymentCash}</div>
                            <div><b>Online</b>: ${record.Online}</div>
                        <div><b>Payment</b>: ${record.Payment}</div>
                    </td>
                    <td class="border p-2 whitespace-nowrap flex-col">
                         <div><b>Status</b>: ${record.Status}</div>
                        <div><b>Level</b>: ${record.Level}</div>
                    </td>
                  
                    <td class="border p-2 whitespace-nowrap flex space-x-1">
                        <button onclick='editRecordCopy(${JSON.stringify(record)})' class="bg-yellow-500 text-white px-2 py-1 rounded text-xs"><i class="fas fa-pen"></i></button>
                        <button onclick='deleteRecordCopy("${record.Id}")' class="bg-red-600 text-white px-2 py-1 rounded text-xs"><i class="fas fa-trash"></i></button>
                    </td>
                </tr>
                `;
                        });
                    }



                    async function fetchRecordsCopy() {
                        const res = await fetch(`${API_URL_COPY}?action=read`);
                        const data = await res.json();
                        allRecordsCopy = data.records;
                        renderTableCopy(allRecordsCopy);
                    }

                    function showFormCopy(record = null) {
                        const form = document.getElementById("crudFormCopy");
                        form.reset();
                        document.getElementById("formContainerCopy").classList.remove("hidden");
                        document.getElementById("formTitleCopy").innerText = record ? "Edit Record" : "Add Record";
                        isEditingCopy = !!record;

                        // Remove previous preview if any
                        let preview = document.getElementById("imagePreviewCopy");
                        if (preview) preview.remove();

                        if (record) {
                            // List of all header fields
                            const fields = ["Id", "Icon", "Date", "Time", "Category", "Tittle", "SubTittle", "Size", "Material", "Color",
                                "Specification", "Ratting", "Price", "Cash", "Online", "Reviews", "Level", "Status", "Filtered"];

                            fields.forEach(key => {
                                let input = form.querySelector(`[name="${key}"]`);
                                if (input) {
                                    if (input.type !== "file") {
                                        input.value = record[key] || "";
                                    }
                                }
                            });

                            // Show existing image preview (cannot prefill file input)
                            if (record.Image || record.Icon) { // use Image field if exists
                                const fileInput = document.getElementById("ImageInputCopy");
                                preview = document.createElement("img");
                                preview.id = "imagePreviewCopy";
                                preview.src = record.Image || record.Icon;
                                preview.className = "mt-2 w-32 h-32 object-cover border rounded";
                                fileInput.parentNode.appendChild(preview);
                            }
                        }
                    }


                    function hideFormCopy() {
                        document.getElementById("formContainerCopy").classList.add("hidden");
                    }

                    function editRecordCopy(record) {
                        showLoader();
                        showFormCopy(record);
                    }

                    async function deleteRecordCopy(id) {
                        showLoader();
                        if (!confirm("Are you sure?")) return;
                        await fetch(API_URL_COPY, { method: "POST", body: new URLSearchParams({ action: "delete", Id: id }) });
                        fetchRecordsCopy();
                    }

                    function getBase64Copy(file) {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.readAsDataURL(file);
                            reader.onload = () => resolve(reader.result);
                            reader.onerror = err => reject(err);
                        });
                    }

                    document.getElementById("searchInputCopy").addEventListener("input", applyFilterCopy);
                    document.getElementById("filterFieldCopy").addEventListener("change", applyFilterCopy);

                    function applyFilterCopy() {
                        const query = document.getElementById("searchInputCopy").value.toLowerCase().trim();
                        const field = document.getElementById("filterFieldCopy").value;
                        let filtered = allRecordsCopy.filter(record => {
                            if (!query) return true;
                            if (field) return String(record[field] || "").toLowerCase().includes(query);
                            return Object.values(record).some(val => String(val).toLowerCase().includes(query));
                        });
                        renderTableCopy(filtered);
                    }

                    document.getElementById("crudFormCopy").addEventListener("submit", async (e) => {
                        e.preventDefault();

                        function fillCurrentDateTime() {
                            const dateInput = document.getElementById('dateInput');
                            const timeInput = document.getElementById('timeInput');

                            const now = new Date();

                            // Format date as YYYY-MM-DD
                            const year = now.getFullYear();
                            const month = String(now.getMonth() + 1).padStart(2, '0');
                            const day = String(now.getDate()).padStart(2, '0');
                            dateInput.value = `${year}-${month}-${day}`;

                            // Format time as HH:MM:SS AM/PM
                            let hours = now.getHours();
                            const minutes = String(now.getMinutes()).padStart(2, '0');
                            const seconds = String(now.getSeconds()).padStart(2, '0');
                            const ampm = hours >= 12 ? 'PM' : 'AM';
                            hours = hours % 12;
                            hours = hours ? hours : 12; // 0 => 12
                            timeInput.value = `${String(hours).padStart(2, '0')}:${minutes}:${seconds} ${ampm}`;
                        }
                        fillCurrentDateTime()
                        // Call the function when window loads
                        window.addEventListener('load', fillCurrentDateTime);

                        const form = e.target;
                        const formData = new FormData(form);
                        const payload = { action: isEditingCopy ? "update" : "create" };

                        // Collect all form fields
                        for (const [key, value] of formData.entries()) {
                            payload[key] = value;
                        }

                        // Handle file input
                        const fileInput = document.getElementById("ImageInputCopy");
                        if (fileInput && fileInput.files.length > 0) {
                            payload.Image = await getBase64Copy(fileInput.files[0]);
                            payload.ImageName = fileInput.files[0].name;
                        }

                        // For updates, make sure the Id is sent
                        if (isEditingCopy && !payload.Id) {
                            alert("Record ID is required for updating.");
                            return;
                        }

                        try {
                            // Convert payload to URLSearchParams safely
                            const body = new URLSearchParams();
                            Object.keys(payload).forEach(key => {
                                if (payload[key] !== undefined && payload[key] !== null) {
                                    body.append(key, payload[key]);
                                }
                            });

                            const response = await fetch(API_URL_COPY, {
                                method: "POST",
                                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                                body: body
                            });

                            const result = await response.text(); // Google Apps Script often returns plain text

                            if (!response.ok) throw new Error(result || "Failed to submit");
                            hideFormCopy();
                            fetchRecordsCopy();
                            const loader = document.getElementById("funLoader");
                            loader.classList.remove("hidden");       // show loader

                        } catch (err) {
                            console.error("Error submitting form:", err);
                            alert("Error submitting form. Check console for details.");
                        }
                    });

                    fetchRecordsCopy();


                    function showLoader() {
                        const loader = document.getElementById("funLoader");
                        const button = event.target; // the clicked button

                        loader.classList.remove("hidden");       // show loader
                        button.classList.add("animate-bounce");  // fun bounce effect

                        setTimeout(() => {
                            loader.classList.add("hidden");        // hide loader
                            button.classList.remove("animate-bounce");

                        }, 5000); // 3s loader
                    }
                </script>

            </section>

            <section id="documents" class="hidden">
                <h2 class="text-orange-500 font-semibold text-xl mb-6">Documents</h2>
                <p class="text-gray-700 text-sm">Manage your documents in this section.</p>
            </section>

            <section id="photos" class="hidden">
                <h2 class="text-orange-500 font-semibold text-xl mb-6">Photos</h2>
                <p class="text-gray-700 text-sm">View and upload photos here.</p>
            </section>

            <section id="sells" class="">
                <div class="flex  justify-end"> <!-- 🔍 Filter Section -->

                    <div class="mb-4 mx-1 flex justify-between md:justify-end space-x-4">
                        <select id="filterField"
                            class=" border rounded-lg shadow-sm p-2  md:pl-2 md:px-4   focus:outline-none text-sm">
                            <option value="">All Fields</option>
                            <option value="Id">Id</option>
                            <option value="Date">Date</option>
                            <option value="Time">Time</option>
                            <option value="Name">Name</option>
                            <option value="Number">Number</option>
                            <option value="Material">Material</option>
                            <option value="Color">Color</option>
                            <option value="Address">Address</option>
                            <option value="City">City</option>
                            <option value="Pincode">Pincode</option>
                            <option value="State">State</option>
                            <option value="Status">Status</option>
                            <option value="Payment">Payment</option>
                            <option value="Other">Other</option>
                        </select>

                        <input type="text" id="searchInput" placeholder="Search..."
                            class="md:w-80 w-[66vw] p-2 border rounded-lg shadow-sm  focus:outline-none text-sm">
                    </div>
                </div>
                <hr>
                <style>
                    .sells {
                        height: 100vh;
                        overflow: auto;
                    }
                </style>

                <div class=" md:mb-80  mx-auto">

                    <!-- Data Table -->
                    <div class="bg-white shadow rounded-lg md:mb-20 w-full  md:max-h-[80vh]">
                        <!-- Wrapper for scrolling -->
                        <div class="overflow-x-auto overflow-y-auto max-h-[98vh] md:max-h-[80vh]">
                            <table class="min-w-full border border-gray-200 text-xs text-gray-700">
                                <thead class="bg-gray-100 text-gray-600 w-full uppercase tracking-wider">
                                    <tr class="">
                                        <th class="p-2 border">Id</th>
                                        <th class="p-2 border">Icon</th>
                                        <th class="p-2 border">Date & Time</th>

                                        <th class="p-2 border">Name & Number</th>

                                        <th class="p-2 border">Size</th>
                                        <th class="p-2 border">Material & Color</th>

                                        <th class="p-2 border">Address & City & Code</th>

                                        <th class="p-2 border">Status</th>

                                        <th class="p-2 border">Level</th>
                                        <th class="p-0 border-transparent"> </th>
                                        <th class="p-2 border">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="tableBody" class="divide-y divide-gray-200">
                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                       <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>

                                    <tr class="animate-pulse hover:bg-gray-50">
                                        <!-- ID -->
                                        <td class="border p-2">
                                            <div class="h-4 w-8 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Image -->
                                        <td class="border p-2 w-28 h-20">
                                            <div class="h-full w-full bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Other / Time / Date -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-4 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Name / Number -->
                                        <td class="border p-2">
                                            <div class="h-4 w-24 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Size -->
                                        <td class="border p-2">
                                            <div class="h-4 w-12 bg-gray-300 rounded"></div>
                                        </td>

                                        <!-- Material / Color -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Address / City / State / Pincode -->
                                        <td class="border p-2 flex flex-col space-y-1 h-2">
                                            <div class="h-3 w-20 bg-gray-300 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Status / Payment -->
                                        <td class="border p-2 flex flex-col space-y-1">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Level -->
                                        <td class="border p-2">
                                            <div class="h-3 w-12 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Image link -->
                                        <td class="border p-2">
                                            <div class="h-3 w-16 bg-gray-200 rounded"></div>
                                        </td>

                                        <!-- Actions -->
                                        <td class="border p-2 flex space-x-1">
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                            <div class="h-6 w-6 bg-gray-300 rounded"></div>
                                        </td>
                                    </tr>
 
 


                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- Form (hidden by default) -->

                    <!-- Add Button -->
                </div>
                <!-- sells-->
                <script>
                    const API_URL = "https://script.google.com/macros/s/AKfycby_gJSJorghtpLgbZjHKO4eJ4f0S1HwDF89FpmFng4CcMedA7L--y8flV_HCaRb2LE-/exec";
                    let editing = false;
                    let allRecords = []; // ✅ global storage for filtering

                    function formatDate(dateValue) {
                        if (!dateValue) return "";
                        if (!isNaN(dateValue)) {
                            let jsDate = new Date(Math.round((dateValue - 25569) * 86400 * 1000));
                            return jsDate.toLocaleDateString("en-GB");
                        }
                        let date = new Date(dateValue);
                        if (isNaN(date)) return dateValue;
                        return date.toLocaleDateString("en-GB");
                    }

                    function formatTime(timeValue) {
                        if (!timeValue) return "";
                        if (!isNaN(timeValue)) {
                            let totalMinutes = Math.round(timeValue * 24 * 60);
                            let hours = Math.floor(totalMinutes / 60);
                            let minutes = totalMinutes % 60;
                            let period = hours >= 12 ? "PM" : "AM";
                            hours = hours % 12 || 12;
                            return `${hours}:${minutes.toString().padStart(2, "0")} ${period}`;
                        }
                        let date = new Date(`1970-01-01T${timeValue}`);
                        if (isNaN(date)) return timeValue;
                        return date.toLocaleTimeString("en-US", { hour: "numeric", minute: "2-digit", hour12: true });
                    }

                    function renderTable(records) {
                        const tbody = document.getElementById("tableBody");
                        tbody.innerHTML = "";
                        records.forEach(record => {
                            tbody.innerHTML += `
          <tr class="hover:bg-gray-50">
          <td class="border p-2 whitespace-nowrap">${record.Id}</td>
        <td class="border p-2 w-28 h-20 flex items-center justify-center">
  <img src="${record.Icon}" alt="Product" class="rounded border-2 w-20 h-20 object-cover" />
</td>

          <td class="border p-2  flex-col">
            <div class="font-extrabold"> ${record.Other} </div>
            <div>${formatTime(record.Time)}</div>
            <div> ${formatDate(record.Date)}</div>
          </td> 
          <td class="border p-2 ">${record.Name} ${record.Number}</td>
   
          <td class="border p-2 whitespace-nowrap">${record.Size}</td>

          <td class="border p-2  whitespace-nowrap flex-col">
            <div><b>Material</b> : ${record.Material}</div>
            <div><b>Color</b> : ${record.Color}</div>
          </td>
 
          <td class="border p-2   w-10 overflow-hidden flex-col">
            <div>${record.Address}}</div>
            <div>${record.City}</div>
            <div> ${record.State}</div>
            <div>${record.Pincode}</div>
          </td>
          <td class="border p-2  whitespace-nowrap flex-col">
            <div><b>Status</b> : ${record.Status}</div>
            <div><b>Payment</b> : ${record.Payment}</div>
          </td>
          <td class="border p-2  whitespace-nowrap flex-col">
            <div >  ${record.Level}</div>
            
          </td>
         
          <td class="border p-2 whitespace-nowrap">
            ${record.Image ? `<a href="${record.Image}" target="_blank" class="text-blue-600 underline">View</a>` : ""}
          </td>
          <td class="border  ">
            <button onclick='editRecord(${JSON.stringify(record)})' class="bg-yellow-500 text-white px-2 py-1 rounded text-xs"> <i class="fas fa-pen"></i></button>
            <button onclick='deleteRecord("${record.Id}")' class="bg-red-600 text-white px-2 py-1 rounded text-xs"> <i class="fas fa-trash"></i></button>
          </td>
        </tr>`;
                        });
                    }

                    async function fetchRecords() {
                        const res = await fetch(`${API_URL}?action=read`);
                        const data = await res.json();
                        allRecords = data.records; // ✅ save for filter
                        renderTable(allRecords);
                    }

                    function showForm(record = null) {
                        document.getElementById("formContainer").classList.remove("hidden");
                        document.getElementById("crudForm").reset();
                        document.getElementById("formTitle").innerText = record ? "Edit Record" : "Add Record";
                        editing = !!record;
                        if (record) {
                            Object.keys(record).forEach(key => {
                                let input = document.querySelector(`[name="${key}"]`);
                                if (input) input.value = record[key];
                            });
                        }
                    }
                    function hideForm() { document.getElementById("formContainer").classList.add("hidden"); showLoader(); }
                    function editRecord(record) {
                        showForm(record);
                        showLoader();
                    }

                    async function deleteRecord(id) {
                        showLoader();
                        if (!confirm("Are you sure ?")) return;
                        await fetch(API_URL, { method: "POST", body: new URLSearchParams({ action: "delete", Id: id }) });
                        fetchRecords();
                    }

                    function getBase64(file) {
                        return new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.readAsDataURL(file);
                            reader.onload = () => resolve(reader.result);
                            reader.onerror = err => reject(err);
                        });
                    }

                    // 🔍 Filter logic
                    document.getElementById("searchInput").addEventListener("input", applyFilter);
                    document.getElementById("filterField").addEventListener("change", applyFilter);

                    function applyFilter() {
                        const query = document.getElementById("searchInput").value.toLowerCase().trim();
                        const field = document.getElementById("filterField").value;
                        let filtered = allRecords.filter(record => {
                            if (!query) return true;
                            if (field) return String(record[field] || "").toLowerCase().includes(query);
                            return Object.values(record).some(val => String(val).toLowerCase().includes(query));
                        });
                        renderTable(filtered);
                    }

                    document.getElementById("crudForm").addEventListener("submit", async (e) => {
                        e.preventDefault();
                        const formData = new FormData(e.target);
                        let payload = { action: editing ? "update" : "create" };
                        for (const [key, val] of formData.entries()) payload[key] = val;
                        const fileInput = document.getElementById("ImageInput");
                        if (fileInput.files.length > 0) {
                            payload.Image = await getBase64(fileInput.files[0]);
                            payload.ImageName = fileInput.files[0].name;
                        }
                        await fetch(API_URL, { method: "POST", body: new URLSearchParams(payload) });
                        hideForm();
                        fetchRecords();
                    });

                    fetchRecords();
                </script>
            </section>

            <section id="message" class="hidden">
                <h2 class="text-orange-500 font-semibold text-xl mb-6">Message</h2>
                <p class="text-gray-700 text-sm">This is the Message section. View and send messages here.</p>
            </section>

            <section id="help" class="hidden">
                <h2 class="text-orange-500 font-semibold text-xl mb-6">Help</h2>
                <p class="text-gray-700 text-sm">Help section content goes here. Find FAQs and support.</p>

            </section>

            <section id="setting" class="hidden">
                <h2 class="text-orange-500 font-semibold text-xl mb-6">Setting</h2>
                <p class="text-gray-700 text-sm">Manage your settings and preferences here.</p>
            </section>
        </main>
    </div>

    <script>
        //Side Navbar 
        function selectSection(sectionId, btn) {
            // Hide all sections
            const sections = document.querySelectorAll('main > section');
            sections.forEach((section) => {
                section.classList.add('hidden');
            });

            // Show selected section
            const selectedSection = document.getElementById(sectionId);
            if (selectedSection) {
                selectedSection.classList.remove('hidden');
            }

            // Update sidebar active states
            const buttons = document.querySelectorAll('aside nav button');
            buttons.forEach((button) => {
                if (button === btn) {
                    button.classList.add('text-orange-500', 'font-semibold');
                    button.classList.remove('text-gray-400');
                } else {
                    button.classList.remove('text-orange-500', 'font-semibold');
                    button.classList.add('text-gray-400');
                }
            });
        }

        // On page load, show "sells" section by default and highlight its menu item
        window.addEventListener('DOMContentLoaded', () => {
            const defaultSection = 'sells';
            const defaultBtn = document.querySelector(`aside nav button[data-section="${defaultSection}"]`);
            if (defaultBtn) {
                selectSection(defaultSection, defaultBtn);
            }
        });
    </script>

    <script>
        const toggleBtn = document.getElementById("menuToggle");
        const sidebar = document.getElementById("sidebar");
        const overlay = document.getElementById("overlay");

        function openSidebar() {
            sidebar.classList.remove("-translate-x-full");
            overlay.classList.remove("hidden");
        }

        function closeSidebar() {
            sidebar.classList.add("-translate-x-full");
            overlay.classList.add("hidden");
        }

        toggleBtn.addEventListener("click", () => {
            if (sidebar.classList.contains("-translate-x-full")) {
                openSidebar();
            } else {
                closeSidebar();
            }
        });

        overlay.addEventListener("click", closeSidebar);

        // Optional: close sidebar when clicking a menu item (mobile only)
        sidebar.querySelectorAll("button").forEach(btn => {
            btn.addEventListener("click", () => {
                if (window.innerWidth < 768) closeSidebar();
            });
        });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
        import {
            getAuth,
            onAuthStateChanged,
            signOut
        } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
        import {
            getFirestore,
            getDoc,
            doc
        } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

        // ✅ Your Firebase config (USE YOUR OWN VALUES HERE)
        const firebaseConfig = {
            apiKey: "AIzaSyAKN5GR18VTFrKNgVG7FenD4aSTX3Q2PbA",
            authDomain: "gift-zone-project.firebaseapp.com",
            projectId: "gift-zone-project",
            storageBucket: "gift-zone-project.appspot.com",
            messagingSenderId: "806465456032",
            appId: "1:806465456032:web:becf8988a6dfabe43646c5",
            measurementId: "G-1ZLMWBP61Y",
        };

        // ✅ Initialize Firebase services
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ✅ On Auth Change: fetch and show user data
        onAuthStateChanged(auth, (user) => {
            if (user) {
                const loggedInUserId = localStorage.getItem("loggedInUserId");
                if (!loggedInUserId) {
                    console.log("User ID not found in local storage.");
                    return;
                }

                const docRef = doc(db, "users", loggedInUserId);
                getDoc(docRef)
                    .then((docSnap) => {
                        if (docSnap.exists()) {
                            const userData = docSnap.data();
                            let bb = document.getElementById("ownername").innerText = userData.firstName || "N/A";
                            document.getElementById("ownermail").innerText = userData.email || "N/A";

                            // ✅ Optional: handle missing lastName gracefully
                            const lNameElement = document.getElementById("loggedUserLName");
                            if (userData.lastName) {
                                lNameElement.innerText = userData.lastName;
                            } else {
                                lNameElement.innerText = "-";
                            }
                        } else {
                            console.log("No user document found in Firestore.");
                        }
                    })
                    .catch((error) => {
                        console.error("Error fetching user data:", error);
                    });
            } else {
                console.log("User not signed in.");
                window.location.href = "index.html"; // Redirect to login
            }
        });

        // ✅ Logout
        const logoutButton = document.getElementById("logout");
        logoutButton.addEventListener("click", () => {
            localStorage.removeItem("loggedInUserId");
            signOut(auth)
                .then(() => {
                    window.location.href = "JSJorghtpLgbZjHKO4eJ4f0S1HwDF89FpmFng4CcMedA7.html";
                })
                .catch((error) => {
                    console.error("Error signing out:", error);
                });
        });

    </script>
</body>

</html>